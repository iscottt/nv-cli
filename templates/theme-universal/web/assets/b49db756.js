import{A as x,p as E,b as C,C as F,z as H,D as T,q as A,E as R,u as r,o as v,c,a as q,F as L,i as N,n as S}from"./065124e3.js";const I={class:"pandastudio-widget-toc mb-10"},M=["onClick","data-header-level","innerHTML"],z={__name:"block-pandastudio-widget-toc",setup($){var i=x("$post",{value:{id:0}}),l=E([]),p=E(""),h=()=>{var e=[];document.documentElement.scrollTop,document.querySelector(".main-content article.nv-blocks").querySelectorAll("h2,h3").forEach(a=>{if(a.getBoundingClientRect().top<=80){var t=a.getAttribute("data-block-id")||a.parentNode.getAttribute("data-block-id")||a.parentNode.parentNode.getAttribute("data-block-id");t&&e.push(t)}}),p.value=e.length?e[e.length-1]:""},_=()=>{i.value.content&&(l.value=i.value.content.blocks.filter(e=>e.type=="header"?e.data.level<=3:e.type=="pandastudio/title"?["h2","h3"].includes(e.data.tag):!1))},n=C(()=>{for(var e=p.value,a=[],t=s=>{if(s){var f=0,d=l.value.filter(w=>w.id==s);d.length&&(f=d[0].data.level||(d[0].data.tag=="h2"?2:3));var g=f-1;if(g>0)for(var m=l.value.slice(0,l.value.indexOf(d[0])),o=m.length-1;o>=0;o--){var u=m[o],b=u.data.level||(u.data.tag=="h2"?2:3);if(b==g)return u.id}}return""};e;)a.push(e),e=t(e);return a});F(i,()=>{_()}),H(()=>{addEventListener("scroll",h),_()}),T(()=>{removeEventListener("scroll",h)});var y=e=>{window.scrollTo({top:document.querySelector(`[data-block-id="${e}"]`).offsetTop-56,left:0,behavior:"smooth"})};return(e,a)=>A((v(),c("div",I,[q("ul",null,[(v(!0),c(L,null,N(r(l),t=>(v(),c("li",{onClick:s=>r(y)(t.id),class:S(["block cursor-hand",{active:r(n).includes(t.id),"text-primary":r(n).includes(t.id),"text-bulge-primary":r(n).includes(t.id),"text-embossed":!r(n).includes(t.id)}]),"data-header-level":t.data.level||(t.data.tag=="h2"?2:3),innerHTML:t.data.text},null,10,M))),256))])],512)),[[R,r(l).length]])}};export{z as default};
